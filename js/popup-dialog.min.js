/**
 * jQuery plugin 'popupDialog' v.2.1.2
 * Copyright (c) 2014 Konstantin Kachurenko <konstantin.kachurenko@gmail.com>
 * The MIT License (MIT) http://opensource.org/licenses/MIT
 */
(function($){'use strict';var $dCache=$('.d-popup');function overlayHandler(e){var modal=e.data.hasOwnProperty('modal');if((modal&&!e.data.modal)||(!modal&&!e.data.base.options.modal)){e.data.base.close();}}function setPosition(){var $this=this.jquery?this:$(this);$this.css('margin','-'+($this.outerHeight(false)/2)+'px 0 0 -'+($this.outerWidth(false)/2)+'px');}function showCallback(){setPosition.call(this.$element);this.$element.add(this.$overlay).addClass('d-show');}$.popupDialog=function(element,options){this.$element=$(element);this.$element.data('popupDialog',this);this.options=false;this.extend(options);this.$overlay=$(document.createElement('DIV')).addClass('d-overlay');$dCache=$('.d-popup');};$.popupDialog.prototype.defaultOptions={modal:false,show:function(){},hide:function(){}};$.popupDialog.prototype.extend=function(params){this.options=$.extend({},this.options?this.options:this.defaultOptions,params);if(typeof this.options.show!=='function'){this.options.show=this.defaultOptions.show;}if(typeof this.options.hide!=='function'){this.options.hide=this.defaultOptions.hide;}};$.popupDialog.prototype.open=function(modal){var obj={base:this};if(modal!==void 0){obj.modal=!!modal;}this.options.show.call(this.$element);this.$element.after(this.$overlay);this.$overlay.off('click',overlayHandler);this.$overlay.on('click',obj,overlayHandler);showCallback.call(this);};$.popupDialog.prototype.close=function(delay){delay=Number(delay);if(delay>0){setTimeout((function(plugin){return function(){plugin.close();};})(this),delay);}else{this.options.hide.call(this.$element);var $content=this.$element.find('.d-content').eq(0);var $clone=$content.clone(true);$content.replaceWith($clone);this.$element.add(this.$overlay).removeClass('d-show');}};$.popupDialog.prototype.realign=function(){setPosition.call(this.$element);};$.fn.popupDialog=function(options){if(jQuery.prototype.on){return this.each(function(i,elem){(new $.popupDialog(elem,options===void 0?{}:options));});}else{setTimeout(function(){throw new Error('jQuery version can not be less than 1.7');},0);return this;}};$(window).on('resize',function(e){$dCache.each(setPosition);});$(document).on('click','[d-trigger]',function(e){e.preventDefault();var $trigger=$(e.target).closest('[d-trigger]');var $popupDialog=$('#'+($trigger.attr('d-trigger')));if($popupDialog.length){if(!($popupDialog.data('popupDialog')instanceof $.popupDialog)){$popupDialog.popupDialog();}$.popupDialog.prototype.open.apply($popupDialog.data('popupDialog'),$trigger.get(0).hasAttribute('d-modal')?[true]:[]);}});$(document).on('click','.d-close',function(e){e.preventDefault();var $dialog=$(e.target).closest('.d-popup');if($dialog.length){if($dialog.data('popupDialog')instanceof $.popupDialog){$dialog.data('popupDialog').close();}}});})(jQuery);